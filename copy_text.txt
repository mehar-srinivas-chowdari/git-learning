from typing import Type, Any
import marshmallow_dataclass
from marshmallow import EXCLUDE
import logging

# Initialize logger
logger = logging.getLogger(__name__)

def convert_to_object(class_object: Type[Any], response: str) -> Any:
    try:
        response_schema = marshmallow_dataclass.class_schema(class_object)()
        return response_schema.loads(response, unknown=EXCLUDE)
    
    except marshmallow.exceptions.ValidationError as error:
        logger.error(error)
        raise ValidationException(*error.args, 480)
    
    except Exception as error:
        logger.error('Validation failed for the given request', exc_info=error)
        raise ValidationException("Validation failed for the given request", 400)